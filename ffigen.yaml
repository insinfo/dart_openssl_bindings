# dart run ffigen --config ffigen.yaml
# https://slproweb.com/products/Win32OpenSSL.html
# https://slproweb.com/download/Win64OpenSSL-3_6_0.msi
# C:\Program Files\OpenSSL-Win64
# C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.34.31933\bin\Hostx64\x64\dumpbin.exe
name: OpenSslFfi
description: Bindings to OpenSSL for Dart.
output: 'lib/src/generated/ffi.dart'
llvm-path:
  - 'C:/LLVM'  # pasta onde está o clang.exe

headers:
  entry-points:
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/ssl.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/crypto.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/evp.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/err.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/pem.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/x509.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/x509v3.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/asn1.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/pkcs12.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/cms.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/ocsp.h'
    - 'C:/Progra~1/OpenSSL-Win64/include/openssl/rand.h'

compiler-opts:
  # OpenSSL
  - '-IC:/Progra~1/OpenSSL-Win64/include'
  - '-IC:/Progra~1/OpenSSL-Win64/include/openssl'

  # MSVC (ajuste a versão 14.41.34120 se for diferente aí)
  - '-IC:/Progra~1/MICROS~4/2022/Community/VC/Tools/MSVC/14.41.34120/include'

  # Windows SDK / UCRT (ajuste a versão 10.0.26100.0)
  - '-IC:/PROGRA~2/WI3CF2~1/10/Include/10.0.26100.0/ucrt'
  - '-IC:/PROGRA~2/WI3CF2~1/10/Include/10.0.26100.0/shared'
  - '-IC:/PROGRA~2/WI3CF2~1/10/Include/10.0.26100.0/um'
 # >>> Supressão de warnings barulhentos do Windows SDK
  - '-Wno-everything'
preamble: |
  // ignore_for_file: camel_case_types, non_constant_identifier_names, unused_element
  // ignore_for_file: constant_identifier_names, public_member_api_docs
  // ignore_for_file: unused_field, lines_longer_than_80_chars
functions:
  include:
    # NOTE: CMS verification API layers added (no new OpenSSL symbols required).
    - BIO_ctrl
    - BIO_new
    - BIO_read
    - BIO_s_mem
    - BIO_write
    - BIO_free
    - BIO_free_all
    - BIO_ADDR_new
    - BIO_ADDR_free
    - BN_new
    - BN_set_word
    - BN_bin2bn
    - BN_to_ASN1_INTEGER
    - BN_free
    - RAND_bytes
    - DTLS_client_method
    - DTLS_server_method
    - ERR_get_error
    - ERR_error_string
    - RSA_new
    - RSA_free
    - RSA_generate_key_ex
    - EVP_PKEY_CTX_new_from_name
    - EVP_PKEY_CTX_new_id
    - EVP_PKEY_CTX_new
    - EVP_PKEY_CTX_free
    - EVP_PKEY_fromdata
    - EVP_PKEY_fromdata_init
    - EVP_PKEY_new
    - EVP_PKEY_set1_RSA
    - EVP_PKEY_free
    - EVP_sha256
    - SSL_CTX_new
    - SSL_CTX_set_cipher_list
    - SSL_CTX_set_default_verify_paths
    - SSL_CTX_set_verify
    - SSL_CTX_use_PrivateKey_file
    - SSL_CTX_use_certificate_file
    - SSL_connect
    - SSL_accept
    - SSL_do_handshake
    - SSL_ctrl
    - SSL_free
    - SSL_shutdown
    - SSL_get0_param
    - SSL_get_error
    - SSL_new
    - SSL_read
    - SSL_set_bio
    - SSL_set_connect_state
    - SSL_set_fd
    - SSL_write
    - SSL_get1_supported_ciphers
    - X509_VERIFY_PARAM_set1_host
    - SSL_CTX_get_cert_store
    - SSL_set_psk_client_callback
    - TLS_client_method
    - TLS_server_method
    - X509_STORE_add_cert
    - d2i_X509
    - X509_free
    - X509_new
    - X509_set_version
    - X509_get_version
    - ASN1_INTEGER_new
    - ASN1_INTEGER_set
    - X509_set_serialNumber
    - ASN1_INTEGER_free
    - X509_getm_notBefore
    - X509_getm_notAfter
    - X509_gmtime_adj
    - ASN1_TIME_adj
    - ASN1_TIME_set
    - ASN1_TIME_set_string
    - X509_time_adj_ex
    - ASN1_TIME_to_tm
    - X509_NAME_new
    - X509_NAME_add_entry_by_txt
    - X509_set_issuer_name
    - X509_set_subject_name
    - X509_REQ_new
    - X509_REQ_free
    - X509_REQ_set_version
    - X509_REQ_get_version
    - X509_REQ_set_subject_name
    - X509_REQ_get_subject_name
    - X509_REQ_set_pubkey
    - X509_REQ_get_pubkey
    - X509_REQ_verify
    - X509_REQ_sign
    - PEM_write_bio_X509_REQ
    - X509_get_subject_name
    - X509_get_issuer_name
    - X509_get_serialNumber
    - i2d_X509
    - i2d_X509_NAME
    - i2d_ASN1_INTEGER
    - CMS_sign
    - CMS_add1_signer
    - CMS_add1_cert
    - CMS_final
    - CMS_ContentInfo_free
    - i2d_CMS_ContentInfo
    - CMS_get1_certs
    - X509_get_ext_d2i
    - X509_NAME_get_index_by_OBJ
    - X509_NAME_get_entry
    - X509_NAME_ENTRY_get_object
    - X509_NAME_ENTRY_get_data
    - OBJ_txt2nid
    - OBJ_obj2txt
    - ASN1_STRING_length
    - ASN1_STRING_get0_data
    - GENERAL_NAMES_free
    - POLICYINFO_free
    - X509V3_set_ctx
    - X509V3_set_ctx_nodb
    - X509V3_EXT_nconf
    - X509V3_EXT_conf_nid
    - X509_EXTENSION_free
    - X509_EXTENSION_create_by_OBJ
    - X509_EXTENSION_create_by_NID
    - X509_add_ext
    - d2i_PKCS12
    - i2d_PKCS12
    - PKCS12_parse
    - PKCS12_free
    - PKCS12_create
    - OPENSSL_sk_new_null
    - OPENSSL_sk_push
    - OPENSSL_sk_num
    - OPENSSL_sk_value
    - OPENSSL_sk_free
    - OPENSSL_sk_pop_free
    - X509_dup
    - X509_up_ref
    - CMS_signed_add1_attr_by_OBJ
    - CMS_SignerInfo_sign
    - CMS_verify
    - d2i_CMS_ContentInfo
    - OBJ_txt2obj
    - ASN1_OBJECT_free
    - ASN1_OCTET_STRING_new
    - ASN1_OCTET_STRING_free
    - ASN1_OCTET_STRING_set
    - X509_store_ctx_new
    - X509_STORE_add_cert
    - X509_NAME_print_ex
    - CRYPTO_free
    - X509_STORE_new
    - X509_STORE_free
    - X509_NAME_free
    - X509_set_pubkey
    - X509_sign
    - X509_verify
    - X509_get_pubkey
    - X509_NAME_oneline
    - ASN1_INTEGER_to_BN
    - BN_bn2dec
    - BN_bn2hex
    - ASN1_TIME_print
    - ASN1_ENUMERATED_new
    - ASN1_ENUMERATED_set
    - ASN1_ENUMERATED_free
    - PEM_write_bio_PrivateKey
    - PEM_write_bio_PUBKEY
    - PEM_write_bio_RSAPublicKey
    - PEM_read_bio_PrivateKey
    - PEM_read_bio_PUBKEY
    - PEM_read_bio_RSAPublicKey
    - PEM_write_bio_X509
    - SSL_CTX_free
    - SSL_CTX_set_info_callback
    - DTLSv1_listen
    - SSL_CTX_set_cookie_generate_cb
    - SSL_CTX_set_cookie_verify_cb
    - SSL_CTX_set_psk_server_callback
    - SSL_CTX_use_psk_identity_hint
    - SSL_set_accept_state
    - OPENSSL_version_major
    - OPENSSL_version_minor
    - OPENSSL_version_patch
    - SSL_CTX_set_security_level
    - PEM_read_bio_X509
    # CRL (X509_CRL) support
    - X509_CRL_new
    - X509_CRL_free
    - X509_CRL_set_version
    - X509_CRL_set_issuer_name
    - X509_CRL_set1_lastUpdate
    - X509_CRL_set1_nextUpdate
    - X509_CRL_add0_revoked
    - X509_CRL_add_ext
    - X509_CRL_add1_ext_i2d
    - X509_CRL_sort
    - X509_CRL_sign
    - i2d_X509_CRL
    - PEM_write_bio_X509_CRL
    - X509_REVOKED_new
    - X509_REVOKED_free
    - X509_REVOKED_set_serialNumber
    - X509_REVOKED_set_revocationDate
    - X509_REVOKED_add1_ext_i2d
    - ASN1_TIME_new
    - ASN1_TIME_set
    - ASN1_TIME_free
    - ASN1_GENERALIZEDTIME_new
    - ASN1_GENERALIZEDTIME_set
    - ASN1_GENERALIZEDTIME_free
    # OCSP (Responder) support
    - d2i_OCSP_REQUEST
    - OCSP_REQUEST_free
    - OCSP_request_onereq_count
    - OCSP_request_onereq_get0
    - OCSP_onereq_get0_id
    - OCSP_id_get0_info
    - OCSP_BASICRESP_new
    - OCSP_BASICRESP_free
    - OCSP_basic_add1_status
    - OCSP_basic_add1_cert
    - OCSP_basic_sign
    - OCSP_response_create
    - OCSP_RESPONSE_free
    - i2d_OCSP_RESPONSE
    - OCSP_copy_nonce
    - OCSP_request_add1_nonce
    - OCSP_REQUEST_new
    - OCSP_request_add0_id
    - OCSP_cert_to_id
    - OCSP_CERTID_free
    - i2d_OCSP_REQUEST
    # EC and Keygen
    - EVP_PKEY_keygen_init
    - EVP_PKEY_keygen
    - EVP_PKEY_CTX_set_params
    - EVP_PKEY_derive_init
    - EVP_PKEY_derive_set_peer
    - EVP_PKEY_derive
    - PEM_write_bio_PKCS8PrivateKey
    # EVP Cipher functions for crypto comparison tests
    - EVP_CIPHER_CTX_new
    - EVP_CIPHER_CTX_free
    - EVP_CIPHER_CTX_ctrl
    - EVP_EncryptInit_ex
    - EVP_EncryptUpdate
    - EVP_EncryptFinal_ex
    - EVP_DecryptInit_ex
    - EVP_DecryptUpdate
    - EVP_DecryptFinal_ex
    - EVP_aes_128_gcm
    - EVP_aes_256_gcm
    - EVP_aes_128_cbc
    - EVP_aes_256_cbc
    - EVP_aes_128_ccm
    - EVP_aes_256_ccm
    - EVP_chacha20_poly1305
    - EVP_chacha20
    # Poly1305 and HMAC
    - EVP_MAC_CTX_new
    - EVP_MAC_CTX_free
    - EVP_MAC_init
    - EVP_MAC_update
    - EVP_MAC_final
    - EVP_MAC_fetch
    - EVP_MAC_free
    # OSSL_PARAM for EVP_MAC
    - OSSL_PARAM_construct_utf8_string
    - OSSL_PARAM_construct_octet_string
    - OSSL_PARAM_construct_end
    # SHA functions
    - EVP_sha1
    - EVP_sha256
    - EVP_sha384
    - EVP_sha512
    - EVP_MD_CTX_new
    - EVP_MD_CTX_free
    - EVP_DigestInit_ex
    - EVP_DigestUpdate
    - EVP_DigestFinal_ex
    - EVP_DigestSignInit
    - EVP_DigestSignUpdate
    - EVP_DigestSignFinal
    - EVP_DigestVerifyInit
    - EVP_DigestVerifyUpdate
    - EVP_DigestVerifyFinal
    - EVP_get_digestbyname
    # HMAC
    - HMAC
    - HMAC_CTX_new
    - HMAC_CTX_free
    - HMAC_Init_ex
    - HMAC_Update
    - HMAC_Final
macros:
  include:
    - BIO_C_SET_BUF_MEM_EOF_RETURN
    - SSL_CTRL_SET_TLSEXT_HOSTNAME
    - SSL_ERROR_SSL
    - SSL_ERROR_ZERO_RETURN
    - SSL_ERROR_SYSCALL
    - SSL_VERIFY_NONE
    - SSL_VERIFY_PEER
    - TLSEXT_NAMETYPE_host_name
    - DTLS_CTRL_GET_TIMEOUT
    - SSL_AD_CLOSE_NOTIFY
    - SSL3_AL_FATAL
    - SSL_AD_UNEXPECTED_MESSAGE
    - EVP_CTRL_GCM_SET_IVLEN
    - EVP_CTRL_GCM_GET_TAG
    - EVP_CTRL_GCM_SET_TAG
    - EVP_CTRL_CCM_SET_IVLEN
    - EVP_CTRL_CCM_GET_TAG
    - EVP_CTRL_CCM_SET_TAG
    - EVP_CTRL_AEAD_SET_IVLEN
    - EVP_CTRL_AEAD_GET_TAG
    - EVP_CTRL_AEAD_SET_TAG
    - CMS_BINARY
    - CMS_DETACHED
    - CMS_PARTIAL
    - CMS_NO_SIGNER_CERT_VERIFY
    - V_ASN1_OBJECT
    - V_ASN1_OCTET_STRING
    - CMS_NOSMIMECAP
    - OCSP_RESPID_KEY
    - GEN_OTHERNAME
    - V_ASN1_UTF8STRING
    - V_ASN1_PRINTABLESTRING
    - V_ASN1_IA5STRING
    - V_ASN1_GENERALSTRING
    - V_ASN1_BMPSTRING
    - V_ASN1_OCTET_STRING
structs:
  # tm is defined manually per-platform in lib/src/utils/
  # because Linux glibc has extra fields (tm_gmtoff, tm_zone) that cause
  # heap corruption if not accounted for. See doc.md for details.
  exclude:
    - tm
unions:
  include: []
enums:
  include: []
globals:
  include: []
unnamed-enums:
  include: []

silence-enum-warning: true  
